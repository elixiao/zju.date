<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>zju.date</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="unit8array 格式是8字节无符号整数数组，如何把它转换为 string 类型呢？  如果不是 utf8 编码的话，可以用下面的方法：  123function uint8arrToStr(uint8arr)&amp;#123;   return String.fromCharCode.apply(null, uint8arr)&amp;#125;  如果使用了 utf8 编码，在浏览器上可以用下面的方法：">
<meta name="keywords" content="JavaScript">
<meta property="og:type" content="article">
<meta property="og:title" content="unit8array转换为字符串">
<meta property="og:url" content="https://zju.date/unit8array-to-string/index.html">
<meta property="og:site_name" content=".">
<meta property="og:description" content="unit8array 格式是8字节无符号整数数组，如何把它转换为 string 类型呢？  如果不是 utf8 编码的话，可以用下面的方法：  123function uint8arrToStr(uint8arr)&amp;#123;   return String.fromCharCode.apply(null, uint8arr)&amp;#125;  如果使用了 utf8 编码，在浏览器上可以用下面的方法：">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2020-07-28T10:56:46.708Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="unit8array转换为字符串">
<meta name="twitter:description" content="unit8array 格式是8字节无符号整数数组，如何把它转换为 string 类型呢？  如果不是 utf8 编码的话，可以用下面的方法：  123function uint8arrToStr(uint8arr)&amp;#123;   return String.fromCharCode.apply(null, uint8arr)&amp;#125;  如果使用了 utf8 编码，在浏览器上可以用下面的方法：">
  
    <link rel="alternate" href="/atom.xml" title="." type="application/atom+xml">
  
  
    <link rel="icon" href="/css/images/banner.jpg">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">.</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">主页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
      </nav>
      <div id="search-form-wrap">
        
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-unit8array-to-string" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/unit8array-to-string/" class="article-date">
  <time datetime="2019-05-13T06:28:07.000Z" itemprop="datePublished">2019-05-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      unit8array转换为字符串
    </h1>
  

      </header>
    



    <div class="article-entry" itemprop="articleBody">
      
        <p>unit8array 格式是8字节无符号整数数组，如何把它转换为 string 类型呢？</p>
<ol>
<li><p>如果不是 utf8 编码的话，可以用下面的方法：</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uint8arrToStr</span>(<span class="params">uint8arr</span>)</span>&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="built_in">String</span>.fromCharCode.apply(<span class="literal">null</span>, uint8arr)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果使用了 utf8 编码，在浏览器上可以用下面的方法：</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 把 Uint8Array 转换为 String</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uint8arrToStr</span>(<span class="params">uint8arr</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> TextDecoder(<span class="string">"utf-8"</span>).decode(uint8arr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 把 String 转换为 Uint8Array</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">str2Uint8arr</span>(<span class="params">str</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> TextEncoder(<span class="string">"utf-8"</span>).encode(str)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
 <a id="more"></a>
</li>
<li><p>但是并非所有浏览器都支持 TextEncoder，跨平台的方法如下：</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uint8arrToStr</span>(<span class="params">array</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> out, i, len, c, char2, char3</span><br><span class="line">    out = <span class="string">""</span></span><br><span class="line">    len = array.length</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span>(i &lt; len) &#123;</span><br><span class="line">        c = array[i++]</span><br><span class="line">        <span class="keyword">switch</span>(c &gt;&gt; <span class="number">4</span>) &#123; </span><br><span class="line">          <span class="keyword">case</span> <span class="number">0</span>: <span class="keyword">case</span> <span class="number">1</span>: <span class="keyword">case</span> <span class="number">2</span>: <span class="keyword">case</span> <span class="number">3</span>: <span class="keyword">case</span> <span class="number">4</span>: <span class="keyword">case</span> <span class="number">5</span>: <span class="keyword">case</span> <span class="number">6</span>: <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">            <span class="comment">// 0xxxxxxx</span></span><br><span class="line">            out += <span class="built_in">String</span>.fromCharCode(c)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">          <span class="keyword">case</span> <span class="number">12</span>: <span class="keyword">case</span> <span class="number">13</span>:</span><br><span class="line">            <span class="comment">// 110x xxxx   10xx xxxx</span></span><br><span class="line">            char2 = array[i++]</span><br><span class="line">            out += <span class="built_in">String</span>.fromCharCode(((c &amp; <span class="number">0x1F</span>) &lt;&lt; <span class="number">6</span>) | (char2 &amp; <span class="number">0x3F</span>))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">          <span class="keyword">case</span> <span class="number">14</span>:</span><br><span class="line">            <span class="comment">// 1110 xxxx  10xx xxxx  10xx xxxx</span></span><br><span class="line">            char2 = array[i++]</span><br><span class="line">            char3 = array[i++]</span><br><span class="line">            out += <span class="built_in">String</span>.fromCharCode(((c &amp; <span class="number">0x0F</span>) &lt;&lt; <span class="number">12</span>) |</span><br><span class="line">                           ((char2 &amp; <span class="number">0x3F</span>) &lt;&lt; <span class="number">6</span>) |</span><br><span class="line">                           ((char3 &amp; <span class="number">0x3F</span>) &lt;&lt; <span class="number">0</span>))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果数组非常大的话，可能耗时会比较久，更好的方式就是使用异步操作：</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uint8arrToStr</span>(<span class="params">uint8arr, callback</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> bb = <span class="keyword">new</span> Blob([uint8arr])</span><br><span class="line">    <span class="keyword">const</span> f = <span class="keyword">new</span> FileReader()</span><br><span class="line">    f.onload = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        callback(e.target.result);</span><br><span class="line">    &#125;</span><br><span class="line">    f.readAsText(bb)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myUint8arr = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>([<span class="number">72</span>, <span class="number">101</span>, <span class="number">108</span>, <span class="number">108</span>, <span class="number">111</span>, <span class="number">32</span>, <span class="number">33</span>])</span><br><span class="line">uint8arrToStr(myUint8arr,<span class="function"><span class="keyword">function</span>(<span class="params">text</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(text);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<!--

中文：日啊
7469 6f6e 3a73 7562 2d30 0a63 6f6e 7465
6e74 2d6c 656e 6774 683a 360a 6d65 7373
6167 652d 6964 3a36 3530 0a64 6573 7469
6e61 7469 6f6e 3a2f 746f 7069 632f 7465
7374 0a65 7870 6972 6573 3a30 0a72 6564
656c 6976 6572 6564 3a66 616c 7365 0a70
7269 6f72 6974 793a 340a 7065 7273 6973
7465 6e74 3a66 616c 7365 0a74 696d 6573
7461 6d70 3a31 3535 3734 3636 3738 3934
3139 0a0a e697 a5e5 958a 000a

英文：a
4d45 5353 4147 450a 7375 6273 6372 6970
7469 6f6e 3a73 7562 2d30 0a63 6f6e 7465
6e74 2d6c 656e 6774 683a 310a 6d65 7373
6167 652d 6964 3a36 3630 0a64 6573 7469
6e61 7469 6f6e 3a2f 746f 7069 632f 7465
7374 0a65 7870 6972 6573 3a30 0a72 6564
656c 6976 6572 6564 3a66 616c 7365 0a70
7269 6f72 6974 793a 340a 7065 7273 6973
7465 6e74 3a66 616c 7365 0a74 696d 6573
7461 6d70 3a31 3535 3734 3636 3837 3333
3737 0a0a 6100 0a

-->

      
    </div>
    <footer class="article-footer">
     <a data-url="https://zju.date/unit8array-to-string/" data-id="ckej9qgc800xcwpq4zr8go0hs" class="article-share-link">Share</a>
     
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/flutter-h-file-not-found/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Flutter.h file not found
        
      </div>
    </a>
  
  
    <a href="/yarn-node-sass-slow/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">yarn安装node-sass太慢</div>
    </a>
  
</nav>

  
</article>

</section>

        

      </div>
      <footer id="footer">
  
    <aside id="sidebar" class="outer">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Angular/">Angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CFA/">CFA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dart/">Dart</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Database/">Database</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/">Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ELK/">ELK</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Elasticsearch/">Elasticsearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Flutter/">Flutter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML/">HTML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/">HTTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/">Mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MongoDB/">MongoDB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/">Nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node-js/">Node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/学习笔记/">学习笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/小程序/">小程序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/诗歌/">诗歌</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/随笔/">随笔</a></li></ul>
    </div>
  </div>


  
</aside>
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 zju.date
      &nbsp;&nbsp;&nbsp;
      contact: <a href="mailto:zju.date@qq.com">zju.date@qq.com</a>
    </div>
  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">主页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
</nav>
    

<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });

</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });

</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });

</script>

<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>